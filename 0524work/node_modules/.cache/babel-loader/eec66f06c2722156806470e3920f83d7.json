{"remainingRequest":"/Users/edz/Documents/chen/webday9work/0524work/node_modules/babel-loader/lib/index.js!/Users/edz/Documents/chen/webday9work/0524work/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/edz/Documents/chen/webday9work/0524work/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/edz/Documents/chen/webday9work/0524work/src/views/mall.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/edz/Documents/chen/webday9work/0524work/src/views/mall.vue","mtime":1622181713181},{"path":"/Users/edz/Documents/chen/webday9work/0524work/node_modules/cache-loader/dist/cjs.js","mtime":1620633447712},{"path":"/Users/edz/Documents/chen/webday9work/0524work/node_modules/babel-loader/lib/index.js","mtime":1620633447741},{"path":"/Users/edz/Documents/chen/webday9work/0524work/node_modules/cache-loader/dist/cjs.js","mtime":1620633447712},{"path":"/Users/edz/Documents/chen/webday9work/0524work/node_modules/vue-loader/lib/index.js","mtime":1620782346830}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9lZHovRG9jdW1lbnRzL2NoZW4vd2ViZGF5OXdvcmsvMDUyNHdvcmsvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IGdldCwgcHV0IH0gZnJvbSAnLi4vdXRpbHMvZmV0Y2guanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ21hbGwnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBqaWZlbjogJycsCiAgICAgIHByb0xpc3Q6IFtdCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0UHJvTGlzdCgpOwogICAgdGhpcy5nZXRKaWZlbigpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6I635Y+W56ev5YiG5L2Z6aKdCiAgICBnZXRKaWZlbjogZnVuY3Rpb24gZ2V0SmlmZW4oKSB7CiAgICAgIGlmIChKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdqaWZlbicpKSA9PT0gJycgfHwgSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnamlmZW4nKSkgPT0gbnVsbCkgewogICAgICAgIHRoaXMuamlmZW4gPSA1MDA7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2ppZmVuJywgSlNPTi5zdHJpbmdpZnkodGhpcy5qaWZlbikpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuamlmZW4gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdqaWZlbicpKTsKICAgICAgfQogICAgfSwKICAgIC8vIOWFkeaNouWVhuWTgQogICAgZXhjaGFuZ2U6IGZ1bmN0aW9uIGV4Y2hhbmdlKGluZGV4KSB7CiAgICAgIHZhciBpZCA9IHRoaXMucHJvTGlzdFtpbmRleF0uX2lkOwogICAgICB2YXIgcHJpY2UgPSB0aGlzLnByb0xpc3RbaW5kZXhdLnByaWNlOwoKICAgICAgaWYgKHRoaXMuamlmZW4gPj0gcHJpY2UpIHsKICAgICAgICB0aGlzLmppZmVuID0gdGhpcy5qaWZlbiAtIHByaWNlOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdqaWZlbicsIEpTT04uc3RyaW5naWZ5KHRoaXMuamlmZW4pKTsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2NoYW5nZUppZmVuJywgdGhpcy5qaWZlbik7CiAgICAgICAgcHV0KCcvc2hvcC9leGNoYW5nZScsIHsKICAgICAgICAgIGlkOiBpZAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIGFsZXJ0KCfnp6/liIbkvZnpop3kuI3otrPvvIEnKTsKICAgICAgfQogICAgfSwKICAgIC8vIOiOt+WPluWVhuWTgeWIl+ihqAogICAgZ2V0UHJvTGlzdDogZnVuY3Rpb24gZ2V0UHJvTGlzdCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGRhdGE7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0KCcvc2hvcC9zaG9wTGlzdCcpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBkYXRhID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF90aGlzLnByb0xpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["mall.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAoBA,SAAA,GAAA,EAAA,GAAA,QAAA,mBAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,MADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,OAAA,EAAA;AAFA,KAAA;AAIA,GAPA;AAQA,EAAA,OARA,qBAQA;AACA,SAAA,UAAA;AACA,SAAA,QAAA;AACA,GAXA;AAYA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,QAFA,sBAEA;AAEA,UAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA,MAAA,EAAA,IAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA,KAAA,IAAA,EAAA;AACA,aAAA,KAAA,GAAA,GAAA;AACA,QAAA,YAAA,CAAA,OAAA,CAAA,OAAA,EAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA,CAAA;AACA,OAHA,MAGA;AACA,aAAA,KAAA,GAAA,IAAA,CAAA,KAAA,CAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;AACA;AACA,KAVA;AAWA;AACA,IAAA,QAZA,oBAYA,KAZA,EAYA;AACA,UAAA,EAAA,GAAA,KAAA,OAAA,CAAA,KAAA,EAAA,GAAA;AACA,UAAA,KAAA,GAAA,KAAA,OAAA,CAAA,KAAA,EAAA,KAAA;;AACA,UAAA,KAAA,KAAA,IAAA,KAAA,EAAA;AACA,aAAA,KAAA,GAAA,KAAA,KAAA,GAAA,KAAA;AACA,QAAA,YAAA,CAAA,OAAA,CAAA,OAAA,EAAA,IAAA,CAAA,SAAA,CAAA,KAAA,KAAA,CAAA;AACA,aAAA,MAAA,CAAA,MAAA,CAAA,aAAA,EAAA,KAAA,KAAA;AACA,QAAA,GAAA,CAAA,gBAAA,EAAA;AAAA,UAAA,EAAA,EAAA;AAAA,SAAA,CAAA;AACA,OALA,MAKA;AACA,QAAA,KAAA,CAAA,SAAA,CAAA;AACA;AACA,KAvBA;AAwBA;AACA,IAAA,UAzBA,wBAyBA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACA,GAAA,CAAA,gBAAA,CADA;;AAAA;AACA,gBAAA,IADA;AAGA,gBAAA,KAAA,CAAA,OAAA,GAAA,IAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,IAAA,CAAA,CAAA;;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AA7BA;AAZA,CAAA","sourcesContent":["\n<template>\n    <div class=\"record-box\">\n        <div class=\"jifen\">\n            积分：{{jifen}}\n        </div>\n        <h3 style=\"margin: 20px 40px;\">商城</h3>\n        <div class=\"pro-list\">\n            <div class=\"pro-item\" v-for=\"(item, index) in proList\" :key=\"index\">\n                <img :src=item.image alt=\"pro\" class=\"pro-img\">\n                <p class=\"pro-name\">{{item.name}}</p>\n                <p class=\"pro-price\"><i class=\"el-icon-coin\"></i>{{item.price}}积分</p>\n                <el-button size=\"mini\" round class=\"pro-btn\" @click=\"exchange(index)\">兑换</el-button>\n            </div>\n            \n        </div>\n    </div>\n</template>\n\n<script>\nimport { get, put } from '../utils/fetch.js'\nexport default {\n    name: 'mall',\n    data() {\n        return {\n            jifen:'',\n            proList: [],\n        }\n    },\n    created(){\n        this.getProList()\n        this.getJifen()\n    },\n    methods: {\n        // 获取积分余额\n        getJifen(){\n            \n            if(JSON.parse(localStorage.getItem('jifen')) === ''|| JSON.parse(localStorage.getItem('jifen')) ==null){\n                this.jifen = 500\n                localStorage.setItem('jifen', JSON.stringify(this.jifen));\n            }else{\n                this.jifen = JSON.parse(localStorage.getItem('jifen'))\n            }\n        },\n        // 兑换商品\n        exchange(index){\n            let id = this.proList[index]._id\n            let price = this.proList[index].price\n            if(this.jifen >= price){\n                this.jifen = this.jifen - price;\n                localStorage.setItem('jifen', JSON.stringify(this.jifen));\n                this.$store.commit('changeJifen', this.jifen)\n                put('/shop/exchange', {id});\n            }else{\n                alert('积分余额不足！')\n            }\n        },\n        // 获取商品列表\n        async getProList() {\n            const data = await get('/shop/shopList');\n            \n            this.proList = JSON.parse(JSON.stringify(data));\n        }\n    },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.record-box{\n    width: auto;\n    height: auto;\n    position: relative;\n    .jifen{\n        width: 900px;\n        height: 200px;\n        margin: 20px 40px;\n        background-image: url(../images/back.png);\n        background-repeat: no-repeat;\n        background-size: 100% 100%;\n        -moz-background-size:100% 100%;\n        color: white;\n        text-align: center;\n        line-height: 200px;\n        font-size: 30px;\n    }\n    .pro-list{\n        width: 900px;\n        height: auto;\n        position: relative;\n        flex-wrap: wrap;\n        margin: 20px 40px;\n        float: left;\n        .pro-item{\n            width: 200px;\n            height: 300px;\n            margin: 0px 20px 10px 0px;\n            display: inline-block;\n            position: relative;\n            box-shadow: 0 0 10px 1px #e3e4e5;\n            border-radius: 10px;\n            .pro-img{\n                width: 200px;\n                height: 220px;\n                position: absolute;\n                border-radius: 10px;\n            };\n            .pro-name{\n                width: 200px;\n                height: 30px;\n                text-overflow: ellipsis;\n                overflow: hidden;\n                white-space: nowrap;\n                margin: 0 5px;\n                top: 230px;\n                position: absolute;\n            }\n            .pro-price{\n                position: absolute;\n                margin-left: 10px;\n                bottom: 0;\n                left: 0;\n                color: lightskyblue;\n            };\n            .pro-btn{\n                position: absolute;\n                margin-right: 10px;\n                bottom: 10px;\n                right: 0;\n            }\n            \n        }\n    }\n}\n</style>"],"sourceRoot":"src/views"}]}